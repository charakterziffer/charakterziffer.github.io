<!DOCTYPE html>
<html lang="de" prefix="og: http://ogp.me/ns#">
<!--
      Hallo Fremde:r,

      sch√∂n, dass du dich umschaust! Falls du Fragen hast oder wissen
      m√∂chtest, wie bestimmte Sachen auf meiner Website funktionieren,
      schreib doch einfach an postfach2b [√§t] web.de oder sende einen
      Post an @charakterziffer@typo.social.

      Weiterhin viele sch√∂ne Entdeckungen!
-->
<head>
<meta charset="UTF-8">
<title>Kommentarspam verhindern // @cz+</title>

<link href='bestand/style.css' rel='stylesheet'>
<link href="bestand/czSlab.woff2" rel="preload" as="font" type="font/woff2" crossorigin>
<link href="https://charakterziffer.github.io/rss.xml" rel="alternate" type="application/rss+xml" title="@cz+ Blogartikel">

<link rel="icon" href="/bestand/favicon.png">
<link rel="apple-touch-icon" href="/bestand/touchicon.png">
<meta name="theme-color" content="#228811">
<meta name="color-scheme" content="light dark">

<meta name="description" content="Spamroboter interpretieren HTML-Entit√§ten anscheinend nicht richtig (z.B. &amp;#58;). K√∂nnte man daraus nicht einen Spamschutz basteln?">
<meta name="author" content="Gerhard Gro√ümann, postfach2b [√§t] web.de">
<meta name="fediverse:creator" content="charakterziffer@typo.social" />
<meta name="keywords" content="Gerhard Gro√ümann, Regensburg, Hohenfels, charakterziffer, Blog, Twitter, Mastodon">

<meta name="robots" content="index, follow">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="referrer" content="strict-origin">

<style> /* QR-Code mit URL f√ºr Ausdrucke, siehe smashingmagazine.com/2013/03/tips-and-tricks-for-print-style-sheets/ */
@media print { header:after {
content: url('https://chart.googleapis.com/chart?cht=qr&chs=110x110&chl=https://charakterziffer.github.io/kommentarspam.html&choe=UTF-8');
position: absolute; right: .5em; top:.2em; z-index:-1; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; } } </style>

<meta property="og:image" content="https://charakterziffer.github.io/bestand/cz200x200.jpg">
</head>

<body>
<header>
<a title="Zur Startseite" href="https://charakterziffer.github.io/"><img src="https://charakterziffer.github.io/bestand/favicon.png" width="59.8" height="59.8" alt="">@charak<br>terziffer</a>
<div>
<form id="suchform" method="GET" action="https://duckduckgo.com/" onsubmit="javascript:document.getElementById('q').value = document.getElementById('keyword').value + ' site:charakterziffer.github.io'">
<input type="text" id="keyword" placeholder="Suche mit DuckDuckGo" aria-label="Seite extern durchsuchen mit DuckDuckGo">
<input type="hidden" id="q" name="q">
<input type="hidden" name="kl" value="de-de">
<input type="hidden" name="kj" value="281">
<input type="hidden" name="kx" value="666">
<input type="hidden" name="k9" value="281">
<input type="hidden" name="kaa" value="839">
<input type="hidden" name="ka" value="Source Sans Pro">
<input type="submit" value="üîç" aria-label="Suchen">
</form>
<nav class="no-hyphens no-print"><ul>
	<li><a href="/archiv.html">Archiv</a></li>
	<li><a href="/extra/index.html">Extra</a></li>
	<li><a href="/rss.xml">RSS</a></li>
	<li><a href="/index.html#impressum">Impressum</a></li>
</ul></nav>
</div>
</header>

<main>
<article>
<time datetime="2018-08-10">Fr, 10. Aug. 2018</time>
<h1>Kommentarspam verhindern</h1>
<p>Etwa seit einem Vierteljahr bekomme ich in meinem Blog fast t√§glich Kommentare. Das w√ºrde mich sehr freuen, wenn es nicht unerw√ºnschte Werbe-Eintr√§ge w√§ren. Als Mail erhalte ich dann zum Beispiel folgenden Kommentar:</p>

<pre><code>post_id: /sommerzeit
date:
&amp;#10;name: Kredit-Heinz
link: http://kredit.tld/
comment: Toller Blogartikel, bitte schreib noch mehr zu diesem interessanten Thema. F√ºr eine schnelle Geldspritze besuche &lt;a href="http://kredit.tld/"&gt;unsere Kreditvergabe&lt;/a&gt; und kassiere sofort! Jetzt auf &lt;a href="http://kredit.tld/"&gt;http://kredit.tld/&lt;/a&gt;
</code></pre>

<p>Solche Spamkommentare pflege ich in mein Blog gar nicht erst ein, sondern l√∂sche sie direkt aus meinem Postausgang. K√ºrzlich ist mir aber etwas aufgefallen, dass mir die Arbeit in Zukunft erleichtern k√∂nnte. Normalerweise sieht eine Mail mit einem handgetippten Kommentar n√§mlich so aus:</p>

<pre><code>post_id: /kommentarspam
date: 9.10.2018, 15:21:17

name: Jana Vogelsang
link: https://jana-bloggt.de/
comment: Das mit dem Kommentarspam kenne ich. Ich habe jetzt ein CAPTCHA eingef√ºgt, seitdem bekomme ich keinen Spam mehr. Vielleicht ist das eine L√∂sung f√ºr dich?
</code></pre>

<p>Im Vergleich mit den Werbekommentaren sind mir zwei Unterschiede aufgefallen.</p>

<h2 id="werbespammer-verwenden-kein-javascript">Werbespammer verwenden kein JavaScript</h2>

<p>Zun√§chst steht im Spamkommentar kein Datum. Ich f√ºge es n√§mlich automatisch mit der Programmiersprache JavaScript ein, wenn im Kommentarformular die Schaltfl√§che ‚ÄûVer√∂ffentlichen‚Äú angeklickt wird. Die Werbespammer scheinen JavaScript nicht auszuf√ºhren.</p>

<p>Theoretisch k√∂nnte ich also ein Script schreiben, so dass man nur kommentieren kann, wenn JavaScript aktiv ist. Ich k√∂nnte die Kommentareingabe zun√§chst unsichtbar machen und erst per JavaScript einblenden. Dann k√∂nnen Spammer das Feld gar nicht ausf√ºllen ‚Ä¶</p>

<p>Praktisch hat JavaScript aber einen Haken: Es gibt n√§mlich Leute, die JavaScript absichtlich abgeschaltet haben. Sie haben m√∂glicherweise Sicherheitsbedenken, m√∂chten <a href="https://irights.info/artikel/was-ist-und-wie-funktioniert-webtracking/23386">Web-Tracking</a> einschr√§nken oder verwenden einen Browser, der JavaScript nicht nutzt (z.B. LYNX). JavaScript w√§re also auch eine H√ºrde f√ºr <a href="https://deliberatedigital.com/blockmetry/javascript-disabled">einige</a> richtige Leser:innen.</p>

<p>Aus demselben Grund verzichte ich in meinem Kommentarformular √ºbrigens auf sogenannte CAPTCHAs. Das sind kleine Zusatzaufgaben, die f√ºr Menschen recht einfach sein sollen, f√ºr Spamroboter aber schwierig l√∂sbar sind; beispielsweise einfache Rechenaufgaben (‚ÄûWie viel ist 2<small>¬†</small>+<small>¬†</small>5?‚Äú) oder ein Bild, in dem man Buchstaben erkennen soll. Ich m√∂chte aber, dass es m√∂glichst einfach ist, in meinem Blog seine Meinung zu √§u√üern ‚Äì ohne sich vorher mit einem bescheuerten CAPTCHA besch√§ftigen zu m√ºssen.</p>

<h2 id="werbespammer-verstehen-keine-html-entit√§ten">Werbespammer verstehen keine HTML-Entit√§ten</h2>

<p>Das zweite, was mir an den Spamkommentaren aufgefallen ist, war die <code>&amp;#10;</code> (oben vor <code>name</code>). Das ist eine HTML-Entit√§t (‚Äú<a href="https://wiki.selfhtml.org/wiki/Zeichenreferenz">HTML Entity</a>‚Äù), eine spezielle Schreibweise, die normalerweise jeder Internetbrowser versteht und richtig interpretiert. Im Quelltext einer Website kann man bestimmte Sonderzeichen anders eingeben, damit sie nicht falsch dargestellt werden. Statt einem <code>‚Ç¨</code> kann man <code>&amp;euro;</code> schreiben, statt <code>√§</code> ein <code>&amp;auml;</code>. Und weil ich wollte, dass in den Kommentarmails vor dem Namen eine Leerzeile steht, habe ich hier ein <code>&amp;#10;</code> eingef√ºgt: das Zeichen f√ºr eine leere Zeile.</p>

<figure><img src="material/bis2020/kommentarspam.jpg" alt="Mauszeiger √ºber einer falsch beschrifteten Schaltfl√§che" />
<figcaption>Spamroboter k√∂nnen offensichtlich keine HTML Entities interpretieren. Aus ‚ÄûVer&amp;ouml;ffentlichen‚Äú machen sie kein ‚ÄûVer√∂ffentlichen‚Äú (Symbolbild).</figcaption>
</figure>

<p>Im Spamkommentar fehlt die Leerzeile und die <em>HTML Entity</em> bleibt stehen. Warum das so ist, wei√ü ich nicht genau. Ich vermute, f√ºr Werbekommentare werden kleine Programme verwendet, die das Internet automatisch nach Kommentarfeldern durchsuchen. Dann √ºberfliegt das Programm die Namen der Textfelder, kopiert seine Werbenachricht hinein und schickt die Eingaben ab. Bei diesem Prozess kommt zu keiner Zeit ein richtiger Webbrowser zum Einsatz (wie Firefox, Safari, Opera oder Chrome) ‚Äì der w√ºrde die HTML-Entit√§ten n√§mlich in die entsprechenden Sonderzeichen umwandeln.</p>

<h2 id="unkomplizierter-barrierefreier-spamschutz">Unkomplizierter, barrierefreier Spamschutz</h2>

<p>Kann man diese Unf√§higkeit der Spamroboter nicht als Abwehrtechnik gegen sie einsetzen? Wie sorge ich daf√ºr, dass ein Kommentar nur abgeschickt werden kann, wenn HTML-Entit√§ten richtig interpretiert werden? Nat√ºrlich bringt es nichts, wie oben im Bild einfach den Text auf der Ver√∂ffentlichen-Schaltfl√§che zu √§ndern, ein Spamprogramm findet den Knopf trotzdem. Aber wie w√§re es, den Werbekommentar einfach an eine falsche Adresse weiterzuleiten?</p>

<p>Mein Kommentarformular wird von dem Anbieter Onlex verarbeitet. Ich leite die Eingaben an eine Adresse wie <code>https://www.onlex.de/_formmailer.php</code> weiter und bekomme sie dann als Mail. Was, wenn ich die Adresse im Formular mit einer HTML-Entit√§t spicke, zum Beispiel <code>https&amp;#58;//www.onlex.de/_formmailer.php</code>? Das <code>&amp;#58;</code> ersetzt den Doppelpunkt, sollte von echten Browsern aber wieder zur√ºckverwandelt werden. Ein Spamprogramm bekommt nach dem Abschicken seines Kommentars dagegen eine Fehlermeldung: Adresse nicht gefunden. So wird kein Kommentar verschickt und der Werbem√ºll landet im Nirgendwo.</p>

<p class="hinterlegt"><b>Update 12.<small>&nbsp;</small>August 2018:</b> Nachdem ich die Methode drei Wochen getestet hatte und es auff√§llig ruhig geworden war, scheint die Adressverschleierung seit vier Tagen nicht mehr zu funktionieren. Zwar stehen in der Kommentarmail immer noch <i>HTML Entities</i>, innerhalb der Absenderadresse k√∂nnen sie die Spammer aber wohl doch aufl√∂sen. Nun ja, dann bleiben die Spamkommentare halt im Mailfilter h√§ngen.</p>

<p>Wei√ü jemand mehr √ºber Spamroboter und HTML-Eintit√§ten? Auch ein einfacher Link zu weiteren Infos w√§re hilfreich. Ich konnte nichts dazu finden, kann mir aber nicht vorstellen, dass noch niemand diese einfache Spambremse entdeckt hat. Oder gibt es normale Browser, bei denen mein Spamschutz Probleme verursacht? Freue mich √ºber erg√§nzende Kommentare!</p>

<p style="margin-bottom:2.25em;">---<br>
<i>Rubrik(en):</i>&nbsp; <a href="archiv.html?methodik">#methodik</a>&nbsp;</p>
</article>



<div class="no-print">
<h2 id="kommentieren">Artikel kommentieren</h2>
<p>Ich lege Wert auf eine respektvolle Diskussion und √ºberpr√ºfe jeden Kommentar, bevor er hier erscheint. Beleidigende oder unsachliche Beitr√§ge ignoriere ich mit gro√üem Vergn√ºgen. Alle Angaben sind freiwillig.</p>

<form name="kommentarformular" id="kommentarformular" method="post"  action="https://www.onlex.de/_formmailer.php?username=charakterziffer" accept-charset="UTF-8" enctype="application/x-www-form-urlencoded" onsubmit="javascript:document.getElementById('aktuelles-datum').value = new Date().toLocaleString('de-DE')">
<input type="hidden" name="post_id" value="/kommentarspam">
<input type="hidden" name="date" id="aktuelles-datum" value="">
<input type="hidden" name="nummer" value="1">

<div>
	<label for="name">Name</label>
	<div><input name="&#10;name" id="name" type="text" size="25" spellcheck="false">
	&nbsp;<i>(Pseudonym m√∂glich)</i></div>
	<!-- &#10; f√ºgt in der Onlex-Mail eine Leerzeile davor ein -->
</div>
<div>
	<label for="mail">E-Mail</label>
	<div><input name="mail" id="mail" type="email" size="25" autocomplete="email" spellcheck="false" autocapitalize="off">
	&nbsp;<i>(wird nicht ver√∂ffentlicht)</i></div>
</div>
<div>
	<label for="link">Website</label>
	<div><input name="link" id="link" type="url" size="25" spellcheck="false" onblur="javascript:if ( (this.value!='') && !(this.value.match(/^https?:\/\//g)) ) { this.value = 'http://' + this.value;}"></div>
	<!-- Beim Verlassen des Feldes: Falls Webadresse nicht leer und nicht mit ‚Äûhttp(s)://‚Äú beginnt, dann erg√§nze ‚Äûhttp://‚Äú. So bekommt der Nutzer wegen type="url" keine Fehlermeldung, auch wenn er das http:// vergisst. -->
</div>
<div>
	<label for="comment">Kommentar</label><br>
	<textarea name="comment" id="comment" rows="8" cols="50" required spellcheck="true"></textarea>
</div>
<input type="hidden" name="&#10;---&#10;Hinweis" value="Mehrzeilige Kommentare in 'Apostrophe' einschlie√üen und um </—Ä><—Ä> erg√§nzen.">
<input name="onlex_password" id="onlex_password" type="hidden" value="5">
<div><input name="submit" id="submit" type="submit" value="Ver√∂ffentlichen"></div>
</form>

<p class="no-hyphens" style="font-size:0.9em;line-height:1.667em;">Formatierungen mit HTML sind m√∂glich, z.<small>&nbsp;</small>B. &lt;em&gt;<em>betont</em>&lt;/em&gt;, &lt;strong&gt;<strong>hervor&shy;gehoben</strong>&lt;/strong&gt; oder &lt;code&gt;<code>Quelltext</code>&lt;/code&gt;. Au√üerdem Verlinkungen (&lt;a href="http://verlinkte-website.de"&gt;Linktext&lt;/a&gt;) und Bilder (&lt;img src="http://pfad-zum.de/bild.jpg" alt="Bildbeschreibung"&gt;).</p>
</div> <!-- .no-print -->
<p style="width:48%; float:left; margin:3.1em 0 1.1em;" class="no-hyphens no-print"><a href="sommerzeit.html">‚Üê Was bringt die Sommerzeit?</a></p>
<p style="width:48%; float:right; text-align:right; margin:3.1em 0 1.1em;" class="no-hyphens no-print"><a href="couscous.html">Couscous mit Gem√ºse ‚Üí</a></p>
<p style="clear:both;" class="no-print"></p>
</main>

<aside class="no-hyphens">
<p>Hallo, ich bin <a href="javascript:new%20Audio('bestand/aussprache.mp3').play()" class="anhoeren" title="Aussprache anh√∂ren">Gerhard Gro√ümann</a> aus Hohen&shy;fels<span class="no-print"> (siehe <a href="/index.html#impressum">Impres&shy;sum/Daten&shy;schutz</a>)</span>. √úber Fragen, Kritik und Anmer&shy;kungen freue ich mich sehr ‚Äì z.<small>&nbsp;</small>B.<span class="no-print"> via <a href="https://typo.social/@charakterziffer" target="_blank" rel="noopener noreferrer">Masto&shy;don</a> oder</span> per Mail an <em>postfach2b [√§t] web.de</em>.</p>
<p class="no-print">Mein <a href="/rss.xml" class="icon-rss">RSS-Feed</a> informiert immer p√ºnkt&shy;lich √ºber neue Artikel. Alle bis&shy;herigen Ein&shy;tr√§ge finden sich <a href="/archiv.html">im Archiv</a>.</p>
<p>Die Texte in diesem Blog stehen unter einer <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.de" class="icon-ccbysa">Crea&shy;tive-Commons-Lizenz 4.0 (Deutsch&shy;land)</a> mit Namens&shy;nennung und Weiter&shy;gabe unter gleichen Bedin&shy;gungen.</p>
</aside>

<script src="https://www.onlex.de/_counter.php?username=charakterziffer" defer></script>
</body>
</html>